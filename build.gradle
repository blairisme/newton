/*
 * MIT License (c)
 *
 * This work is licensed under the MIT License. To view a copy of this
 * license, visit
 *
 *      https://opensource.org/licenses/MIT
 *
 * Author: Blair Butterworth
 */

 buildscript {
   repositories {
     jcenter()
   }

   dependencies {
     classpath 'org.akhikhl.gretty:gretty:2.0.0'
   }
 }

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'war'
apply plugin: 'jacoco'
apply plugin: 'checkstyle'
apply plugin: 'org.akhikhl.gretty'

group = 'org.ucl.newton'
version = '0.0.1'

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
	mavenCentral()
}

dependencies {
	compile group: 'javax.servlet', name: 'jstl', version: '1.2'
	compile group: 'javax.inject', name: 'javax.inject', version: '1'

	compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.25'
    compile group: 'org.thymeleaf', name: 'thymeleaf', version: '3.0.9.RELEASE'
    compile group: 'org.thymeleaf', name: 'thymeleaf-spring5', version: '3.0.9.RELEASE'
    compile group: 'org.thymeleaf.extras', name: 'thymeleaf-extras-springsecurity4', version: '3.0.2.RELEASE'

	compile group: 'org.springframework', name: 'spring-web', version: '5.0.2.RELEASE'
	compile group: 'org.springframework', name: 'spring-webmvc', version: '5.0.2.RELEASE'

    compile group: 'org.springframework.security', name: 'spring-security-core', version: '5.0.6.RELEASE'
    compile group: 'org.springframework.security', name: 'spring-security-web', version: '5.0.6.RELEASE'
    compile group: 'org.springframework.security', name: 'spring-security-config', version: '5.0.6.RELEASE'

    compile group: 'org.ocpsoft.prettytime', name: 'prettytime', version: '4.0.1.Final'

	testCompile group: 'junit', name:'junit', version: '4.11'
	testCompile group: 'org.mockito', name:'mockito-core', version: '2.7.22'
}

gretty {
  contextPath = '/'
  httpPort = 8090
  jacocoEnabled false
}

checkstyle {
  sourceSets = [project.sourceSets.main]
}

jacocoTestReport {
  reports {
    xml.enabled true
    html.enabled = true
  }
}

task report(dependsOn: ['jacocoTestReport']){
  //
}

project.tasks.check.dependsOn jacocoTestCoverageVerification

jacocoTestCoverageVerification {
  violationRules {
    rule {
      limit {
        minimum = 0.5
      }
    }
  }
}
